# راه حل مشروح  (writeup) برای چالش (با من بخوان)  

پس از دانلود فایل  ابتدا با استفاده از دستور زیر نوع فایل را مشخص می کنیم  
```
$ file bamanbekhan  
```


![تصویر۱](http://164.132.117.34/bamanbekhan/1.JPG)  

سپس طبق ویدئو های آموزشی به سراغ دستور binwalk رفتیم و با اجرای دستور زیر:
```
$ binwalk bamanbekhan
```

خروجی زیر حاصل می شود

![تصویر۲](http://164.132.117.34/bamanbekhan/2.JPG)

متوجه می شویم که فایل ما حاوی قسمتی با فایل سیستم از نوع squashfs بوده که با استفاده از دستور mount  سعی در mount کردن آن داشتیم اما موفق نبودیم  و خروجی زیر حاصل گشت:

```
$ mkdir mnt  
$ sudo mount -o loop bamanbekhan mnt  
$ sudo mount -t squashfs bamanbekhan mnt/
```

![تصویر۳](http://164.132.117.34/bamanbekhan/3.JPG)

 بعد از کمی جست و جو در مورد فایل سیستم squashfs به این نتیجه رسیدیم که با استفاده از دستور زیر اقدام به باز کردن فایل و mount کردن به صورت خودکار کنیم.
 
 ```
 $ binwalk -Me bamanbekhan
 ```

با اجرای دستور فوق خروجی binwalk حاصل گشته و همچنین محتویات مربوط به قسمت فایل سیستم  squashfs در فولدر _bamanbekhan.extracted به صورت خودکار mount شده است  
خروجی زیر دستور tree بوده که لیست فولدر ها و فایل های mount شده را نشان می دهد.

![تصویر۴](http://164.132.117.34/bamanbekhan/4.JPG)

فولدر squashfs-root همان mount شده فایل 28.squash  می باشد (یک نوع فایل با فایل سیستم squashfs) که به صورت خودکار در فولدر squashfs-root  mount شده است و حاوی یک فایل با نام zero.img می باشد.
حال به سراغ فایل zero.img می رویم و با دستور file سعی می کنیم نوع فایل را مشخص کنیم که اطلاعات چندانی به دست نمی آوریم:

```
$ cd _bamanbekhan.extracted/squashfs-root/  
$ flle zero.img
```

![تصویر۵](http://164.132.117.34/bamanbekhan/5.JPG)

پس از اجرای دستور binwalk و دریافت خروجی طولانی و نه چندان مطلوب 

![تصویر۶](http://164.132.117.34/bamanbekhan/6.JPG)

به سراغ mount کردن با استفاده از دستور mount می رویم طبق دستورات زیر فایل zero.img را mount می کنیم.

```
$ mkdir mnt  
$ sudo mount -o loop zero.img mnt/
```

پس از mount کردن محتوای فولدر mount شده را مشاهده می کنیم و خروجی زیر حاصل می شود

```
$ tree
$ ls -la mnt/
```

![تصویر۷](http://164.132.117.34/bamanbekhan/7.JPG)

با دستور زیر سعی در مشخص کردن نوع فایل های mount شده می کنیم

```
$ cd mnt
$ file * .*
```

و خروجی زیر حاصل می شود

![تصویر۸](http://164.132.117.34/bamanbekhan/8.JPG)

متوجه می شویم که یک فایل از نوع PostScript با نام  rand_ موجود است که پس از اجرا شدن خروجی pdf می دهد. به دلیل اینکه این فایل در داخل فولدر mount شده با سطح دسترسی read-only قرار دارد نمی توانیم با باز کردن آن اقدام به اجرای کد های PostScript داخل آن کنیم. به همین دلیل فایل را از فولدر  mount شده خارج کرده و با انتقال به فولدری دیگر، اقدام به باز کردن فایل کرده و پس از اجرا شدن کدهای PostScript فایل pdf ما ساخته شده و flag را داخل فایل مشاهده می کنیم

```
$ cp rand_ ../  
$ cd ../
```

پس از باز کردن فایل در فولدر با سطح دسترسی مجاز فایل pdf ساخته شده و می توانیم flag را درون آن مشاهده کنیم.

![تصویر۹](http://164.132.117.34/bamanbekhan/9.png)

با احترام 
> (KooroshRZ)
